% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metagenomeSeq.R
\name{run_metagenomeseq}
\alias{run_metagenomeseq}
\title{Run MetagenomeSeq Analysis}
\usage{
run_metagenomeseq(
  se,
  variable = NULL,
  model = "fitZig",
  zeroMod = NULL,
  useMixedModel = FALSE,
  useCSSoffset = TRUE,
  max_significance = 0.05
)
}
\arguments{
\item{se}{A SummarizedExperiment object containing normalized gene/pathway
abundance values.}

\item{variable}{A character string specifying the name of the variable of
interest to include in the model, matching the desired column name of the
sample metadata.}

\item{model}{A character string specifying the model to use. Options are
"fitZig" (default) or "fitFeatureModel".}

\item{zeroMod}{The model to account for the change in the number of features
observed as a linear effect of the depth of coverage. Default is NULL.}

\item{useMixedModel}{Estimate the correlation between duplicate features or
replicates using duplicateCorrelation.}

\item{useCSSoffset}{Whether to include the default scaling parameters in the
model. Default is FALSE.}

\item{max_significance}{The p-value threshold for significance. Default is
0.05.}
}
\value{
A data frame (tibble) containing the results of the MetagenomeSeq
analysis.
}
\description{
MetagenomeSeq is designed to determine features (such as Operational
Taxanomic Unit (OTU), species, genes, etc.) that are differentially abundant
between two or more groups of multiple samples
(https://www.cbcb.umd.edu/software/metagenomeSeq). It address the effects of
both normalization and under-sampling of microbial communities on disease
association detection and the testing of feature correlations. For this
function, features consist on the abundance of gene families or metabolic
pathways of multiple samples, obtained using HUMAnN3
(https://huttenhower.sph.harvard.edu/humann).
}
\details{
The function takes a SummarizedExperiment object containing normalized gene/
pathway abundance values as the assay and metadata as the column data, as
well as several parameter options to run the analysis, using a zero-inflated
Gaussian mixture model as default (\code{fitZig()}). To use a zero-inflated
Log-Normal mixture model for each feature (\code{fitFeatureModel()}), the argument
\code{model}should be modified (\code{model = "fitFeatureModel"}).It returns the
results of the analysis as a data frame (tibble).
}
\examples{
# Read HUMAnN3 & MetagenomeSeq Analysis
da_result <- read_humann(
  file_path = system.file("extdata", "All_genefam_cpm_kegg.tsv", package = "microfunk"),
  metadata = system.file("extdata", "ex_meta.csv", package = "microfunk")
 ) \%>\% run_metagenomeseq(variable = "ARM")

da_result
}
